<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Motor Insurance Quote</title>
    <link rel="icon" type="image/x-icon" href="/css/images/favicon.ico">
    <link rel="shortcut icon" href="/css/images/favicon.ico" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/vendor/choices/choices.min.css"/>
    <style>
        body { font-family: 'Inter', sans-serif; }
        :root {
            --field-py: 0.5rem;
            --field-border-color: #e91c63;
            --field-focus-border-color: #c2185b;
            --field-disabled-border-color: #d1d5db;
            --field-disabled-bg-color: #f3f4f6;
        }
        .form-input-style {
            border: none; border-bottom: 2px solid var(--field-border-color); border-radius: 0;
            padding-left: 0.25rem; padding-right: 0.25rem; padding-top: var(--field-py); padding-bottom: var(--field-py);
            background-color: transparent; box-shadow: none;
            @apply mt-1 block w-full focus:outline-none focus:ring-0 focus:border-[var(--field-focus-border-color)];
        }
        input.form-input-style:disabled {
            border-bottom-color: var(--field-disabled-border-color); background-color: var(--field-disabled-bg-color); cursor: not-allowed; opacity: 0.7;
        }
        /* Specific style for the number input to allow for adornments */
        input[type="number"].form-input-style {
            padding-left: 2.5rem; /* Adjust based on AED prefix */
            padding-right: 6rem; /* Adjust based on range text */
        }

        select:not([data-choice]) {
            border: none; border-bottom: 2px solid var(--field-border-color); border-radius: 0;
            padding-left: 0.25rem; padding-right: 2.5rem; padding-top: var(--field-py); padding-bottom: var(--field-py);
            background-color: transparent; box-shadow: none; appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23e91c63' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em;
            @apply mt-1 block w-full focus:outline-none focus:ring-0 focus:border-[var(--field-focus-border-color)];
        }
        select:not([data-choice]):disabled {
            border-bottom-color: var(--field-disabled-border-color); background-color: var(--field-disabled-bg-color); cursor: not-allowed; opacity: 0.7;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
        }
        .choices__inner {
            background-color: transparent !important; border: none !important; border-bottom: 2px solid var(--field-border-color) !important; border-radius: 0 !important;
            padding-left: 0.25rem !important; padding-right: 0.25rem !important; padding-top: var(--field-py) !important; padding-bottom: var(--field-py) !important;
            min-height: initial !important; line-height: 1.5rem;
        }
        .choices.is-focused .choices__inner { border-bottom-color: var(--field-focus-border-color) !important; box-shadow: none !important; }
        .choices__list--dropdown { border-color: var(--field-border-color) !important; border-radius: 0 !important; z-index: 20 !important; }
        .choices__list--dropdown .choices__item--selectable.is-highlighted { background-color: #fce4ec !important; }
        .choices__input { padding-top: 0 !important; padding-bottom: 0 !important; margin-bottom: 0 !important; }
        .display-field {
            display: block; width: 100%; padding: var(--field-py) 0.25rem; min-height: calc(2 * var(--field-py) + 1.5rem + 2px); line-height: 1.5rem; color: #4b5563;
            border-bottom: 2px solid var(--field-disabled-border-color); background-color: #f9fafb; @apply mt-1;
        }
        /* Styling for Radio Buttons */
        .form-radio {
            @apply focus:ring-offset-0 focus:ring-2 focus:ring-[#c2185b] focus:ring-opacity-50 border-gray-400 text-[#e91c63];
        }
        /* Style for slider thumb */
        .themed-slider::-webkit-slider-thumb {
            appearance: none;
            margin-top: -6px; /* Adjust based on track/thumb height */
            background-color: #e91c63; /* Theme color */
            height: 1rem; /* 16px */
            width: 1rem; /* 16px */
            border-radius: 9999px; /* Full circle */
            cursor: pointer;
        }
        .themed-slider::-moz-range-thumb {
            background-color: #e91c63; /* Theme color */
            height: 1rem;
            width: 1rem;
            border-radius: 9999px;
            border: none;
            cursor: pointer;
        }
        /* Remove number input spinners */
        input[type=number]::-webkit-outer-spin-button,
        input[type=number]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }

        /* New styles for step visibility and progress bar */
        .step-section {
            display: none; /* Hidden by default, JavaScript will manage visibility */
        }
        .step-section.active {
            display: block;
        }
        .progress-bar-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 5px;
            height: 10px;
            margin-bottom: 2rem;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            width: 0%; /* Initial width */
            background-color: #e91c63;
            border-radius: 5px;
            transition: width 0.5s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="max-w-4xl mx-auto p-6 md:p-8 bg-white rounded-lg shadow-md mt-10 mb-10">
        <div class="flex justify-center mb-8 bg-[#c8284a] p-4 rounded-lg shadow">
            <img src="https://savington.ae/wp-content/uploads/2024/05/logo-light.png" alt="Savington Logo" class="h-12 md:h-16">
        </div>
        <h1 class="text-3xl font-bold text-center mb-6 text-gray-800">Health Insurance Quote</h1>

        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar" style="width: 0%;"></div>
        </div>
        <p id="progressText" class="text-center text-sm text-gray-600 mb-6">Step 1 of 2: Owner Details</p>

        <form id="quoteForm" novalidate>
            <div id="step1" class="step-section active">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">About Personal</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6 mb-6">

                    <div>
                        <label for="ownerNameInput" class="block text-sm font-medium text-gray-700">Full Name:</label>
                        <input type="text" id="ownerNameInput" name="ownerNameInput" class="form-input-style" placeholder="Enter Full Name" required>
                        <p class="text-red-500 text-xs italic hidden" id="ownerNameInputError">Full Name is required.</p>
                    </div>

                    <div>
                        <label for="nationalitySelect" class="block text-sm font-medium text-gray-700">Nationality:</label>
                        <select id="nationalitySelect" name="nationalitySelect" class="" placeholder="Select Nationality" required>
                            <option value="">Loading Nationalities...</option>
                        </select>
                        <p class="text-red-500 text-xs italic hidden" id="nationalitySelectError">Nationality is required.</p>
                    </div>

                    <div>
                        <label for="ownerEmailInput" class="block text-sm font-medium text-gray-700">Email Address:</label>
                        <input type="email" id="ownerEmailInput" name="ownerEmailInput" class="form-input-style" placeholder="example@domain.com" required>
                        <p class="text-red-500 text-xs italic hidden" id="ownerEmailInputError">Valid Email Address is required.</p>
                    </div>

                    <div>
                        <label for="ownerMobileInput" class="block text-sm font-medium text-gray-700">Mobile Number:</label>
                        <input type="tel" id="ownerMobileInput" name="ownerMobileInput" class="form-input-style" placeholder="e.g., 05XXXXXXXX" required>
                        <p class="text-red-500 text-xs italic hidden" id="ownerMobileInputError">Mobile Number is required.</p>
                    </div>

                    <div>
                        <label for="ownerDobInput" class="block text-sm font-medium text-gray-700">Owner's Date of Birth:</label>
                        <input type="date" id="ownerDobInput" name="ownerDobInput" class="form-input-style" required>
                        <p class="text-red-500 text-xs italic hidden" id="ownerDobInputError">Date of Birth is required.</p>
                    </div>

                    <div>
                        <label for="driverAgeDisplay" class="block text-sm font-medium text-gray-700">Driver Age:</label>
                        <span id="driverAgeDisplay" class="display-field">---</span>
                    </div>

                    <div class="md:col-span-2">
                        <label for="licenseIssueDateInput" class="block text-sm font-medium text-gray-700">Owner's UAE Driving License Issue Date:</label>
                        <input type="date" id="licenseIssueDateInput" name="licenseIssueDateInput" class="form-input-style" required>
                        <p class="text-red-500 text-xs italic hidden" id="licenseIssueDateInputError">License Issue Date is required.</p>
                    </div>
                </div>
                <button type="button" id="nextStepButton" class="w-full mt-6 bg-[#e91c63] hover:bg-[#d81b60] text-white font-bold py-2.5 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#e91c63] focus:ring-offset-2 focus:ring-opacity-75 transition duration-150 ease-in-out">
                    Next: Personal Details
                </button>
            </div>

            <div id="step2" class="step-section">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Vehicle Details</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6 mb-6">

                    <div> <label for="modelYear" class="block text-sm font-medium text-gray-700">Model Year:</label>
                        <select id="modelYear" name="modelYear" class="" required> <option value="">Select Model Year</option> </select>
                        <p class="text-red-500 text-xs italic hidden" id="modelYearError">Model Year is required.</p>
                    </div>

                    <div> <label for="make" class="block text-sm font-medium text-gray-700">Make:</label>
                        <select id="make" name="make" class="" placeholder="Select Make" required> <option value="">Loading Makes...</option> </select>
                        <p class="text-red-500 text-xs italic hidden" id="makeError">Make is required.</p>
                    </div>

                    <div> <label for="model" class="block text-sm font-medium text-gray-700">Model:</label>
                        <select id="model" name="model" disabled class="" required> <option value="">Select Year and Make first</option> </select>
                        <p class="text-red-500 text-xs italic hidden" id="modelError">Model is required.</p>
                    </div>

                    <div> <label for="trim" class="block text-sm font-medium text-gray-700">Trim:</label>
                        <select id="trim" name="trim" disabled class="" required> <option value="">Select Model first</option> </select>
                        <p class="text-red-500 text-xs italic hidden" id="trimError">Trim is required.</p>
                    </div>

                    <div> <label for="bodyType" class="block text-sm font-medium text-gray-700">Body Type:</label>
                        <select id="bodyType" name="bodyType" disabled class="" required> <option value="">Select Trim first</option> </select>
                        <p class="text-red-500 text-xs italic hidden" id="bodyTypeError">Body Type is required.</p>
                    </div>

                    <div> <label for="engineSize" class="block text-sm font-medium text-gray-700">Engine Size:</label>
                        <select id="engineSize" name="engineSize" disabled class="" required> <option value="">Select Body Type first</option> </select>
                        <p class="text-red-500 text-xs italic hidden" id="engineSizeError">Engine Size is required.</p>
                    </div>

                    <div> <label for="doorsSelect" class="block text-sm font-medium text-gray-700">Number of Doors:</label>
                        <select id="doorsSelect" name="doorsSelect" disabled class="" required> <option value="">Select Body Type first</option> </select>
                        <p class="text-red-500 text-xs italic hidden" id="doorsSelectError">Number of Doors is required.</p>
                    </div>

                    <div> <label for="transmissionSelect" class="block text-sm font-medium text-gray-700">Transmission:</label>
                        <select id="transmissionSelect" name="transmissionSelect" disabled class="" required> <option value="">Select Engine Size first</option> </select>
                        <p class="text-red-500 text-xs italic hidden" id="transmissionSelectError">Transmission is required.</p>
                    </div>

                    <div> <label for="cylinderSelect" class="block text-sm font-medium text-gray-700">Cylinders:</label>
                        <select id="cylinderSelect" name="cylinderSelect" disabled class="" required> <option value="">Select Engine Size first</option> </select>
                        <p class="text-red-500 text-xs italic hidden" id="cylinderSelectError">Cylinders is required.</p>
                    </div>

                    <div> <label for="citySelect" class="block text-sm font-medium text-gray-700">City of Registration:</label>
                        <select id="citySelect" name="citySelect" class="" required> <option value="">Select City</option> <option value="Dubai">Dubai</option><option value="Abu Dhabi">Abu Dhabi</option><option value="Sharjah">Sharjah</option><option value="Ajman">Ajman</option><option value="Umm Al Quwain">Umm Al Quwain</option><option value="Ras Al Khaimah">Ras Al Khaimah</option><option value="Fujairah">Fujairah</option> </select>
                        <p class="text-red-500 text-xs italic hidden" id="citySelectError">City of Registration is required.</p>
                    </div>

                    <div class="md:col-span-2"> <label class="block text-sm font-medium text-gray-700 mb-1">Vehicle Specification:</label>
                        <div class="mt-2 flex items-center space-x-6">
                            <label class="inline-flex items-center">
                                <input type="radio" class="form-radio" name="vehicleSpec" value="GCC" checked>
                                <span class="ml-2 text-sm text-gray-800">GCC</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" class="form-radio" name="vehicleSpec" value="Non-GCC"> <span class="ml-2 text-sm text-gray-800">Non GCC</span>
                            </label>
                        </div>
                        <p class="text-red-500 text-xs italic hidden" id="vehicleSpecError">Vehicle Specification is required.</p>
                    </div>

                    <div> <label for="ncdSelect" class="block text-sm font-medium text-gray-700">No Claim Discount (Years):</label>
                        <select id="ncdSelect" name="ncdSelect" class="" required> <option value="0">0 Years</option><option value="1">1 Year</option><option value="2">2 Years</option><option value="3">3 Years</option><option value="4">4 Years</option><option value="5">5 Years</option> </select>
                        <p class="text-red-500 text-xs italic hidden" id="ncdSelectError">No Claim Discount is required.</p>
                    </div>

                    <div class="md:col-span-2"> <label for="sumInsuredTextInput" class="block text-sm font-medium text-gray-700">Vehicle Value (Sum Insured in AED)</label>
                        <div class="mt-1 relative rounded-md shadow-sm border-b-2 border-[var(--field-border-color)] focus-within:border-[var(--field-focus-border-color)]"> <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm"> </span>
                                </div>
                                <input type="number" name="sumInsuredText" id="sumInsuredTextInput"
                                       class="block w-full border-0 pl-10 pr-28 py-2 sm:text-sm bg-transparent focus:outline-none focus:ring-0 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed disabled:opacity-70"
                                       placeholder="Value"
                                       aria-describedby="sum-insured-range-text"
                                       step="100"
                                       disabled required> <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm whitespace-nowrap" id="sum-insured-range-text">
                                        Range: ---
                                    </span>
                                </div>
                        </div>
                        <p class="mt-1 text-xs text-gray-500" id="sum-insured-range-description">Min/Max determined after selecting vehicle details.</p>
                        <p id="sumInsuredTextInputError" class="text-red-600 text-xs mt-1 hidden">Value must be within the allowed range.</p>

                        <div id="sumInsuredContainer" class="mt-4 opacity-50 pointer-events-none"> <label for="sumInsuredSlider" class="block text-sm font-medium text-gray-500 mb-2">Adjust Using Slider (Optional)</label>
                                <input type="range" id="sumInsuredSlider" name="sumInsuredSlider" min="0" max="100000" step="100" value="50000" disabled
                                       class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer themed-slider">
                                <div class="flex justify-between text-xs text-gray-500 mt-1 px-1">
                                    <span id="sumInsuredMinLabel">Min</span>
                                    <span id="sumInsuredMaxLabel">Max</span>
                                </div>
                                <div id="sumInsuredErrorDisplay" class="text-red-600 text-xs mt-1 hidden">Error</div>
                            </div>
                    </div>
                </div>

                <div class="mt-6 flex justify-between gap-4">
                    <button type="button" id="backStepButton" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2.5 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-opacity-75 transition duration-150 ease-in-out">
                        Back
                    </button>
                    <button type="submit" id="getPremiumButton" class="flex-1 bg-[#e91c63] hover:bg-[#d81b60] text-white font-bold py-2.5 px-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#e91c63] focus:ring-offset-2 focus:ring-opacity-75 transition duration-150 ease-in-out">
                        Get Premium
                    </button>
                </div>
            </div>

            <div id="tokenDisplay" class="mt-4 text-xs text-gray-400"></div>

            <div id="quoteResult" class="mt-4 text-sm"></div>
        </form>

        <div id="errorModal" class="fixed inset-0 bg-gray-600 bg-opacity-75 overflow-y-auto h-full w-full flex items-center justify-center hidden z-50 transition-opacity duration-300 ease-out" aria-labelledby="modal-title" role="dialog" aria-modal="true">
            <div class="relative mx-auto p-6 border w-11/12 sm:w-3/4 md:w-1/2 lg:w-1/3 shadow-xl rounded-lg bg-white transform transition-all duration-300 ease-out scale-95 opacity-0" id="errorModalContent">
                <button id="closeErrorModalButtonTop" type="button" class="absolute top-3 right-3 text-gray-400 hover:text-gray-600 focus:outline-none" aria-label="Close modal">
                    <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" >
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
                <div class="mt-3 text-center sm:mt-0 sm:text-left">
                    <div class="flex items-center mb-3">
                        <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10">
                            <svg class="h-6 w-6 text-red-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.008v.008H12v-.008z" />
                            </svg>
                        </div>
                        <h3 class="text-lg leading-6 font-medium text-gray-900 ml-3" id="modal-title">Request Failed</h3>
                    </div>
                    <div class="mt-2 pl-0 sm:pl-12">
                        <p id="errorMessageText" class="text-sm text-gray-600">An error occurred.</p>
                    </div>
                </div>
                <div class="mt-5 sm:mt-4 sm:flex sm:flex-row-reverse">
                    <button id="closeErrorModalButtonBottom" type="button" class="inline-flex justify-center w-full rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm"> OK </button>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="/vendor/choices/choices.min.js"></script>
    <script src="script.js"></script>

</body>
</html>
